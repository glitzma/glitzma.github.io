(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{467:function(t,s,a){"use strict";a.r(s);var n=a(5),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("TOC"),t._v(" "),a("h2",{attrs:{id:"spreadjs需要做一个填报二维表的功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spreadjs需要做一个填报二维表的功能"}},[t._v("#")]),t._v(" spreadjs需要做一个填报二维表的功能")]),t._v(" "),a("p",[t._v("由于业务需要，在平台端要加入一个填报功能，让用spreadjs写。上次做的贫普的平台端填报是数据一对一的。现在的数据是一个二维表的填报形式。这个二维表要到要求能够根据数据来回显，页面默认是一条空行。可以添加行删除行。由于这个表是进行问卷调查的，所以还有一个cellType的应用。")]),t._v(" "),a("h2",{attrs:{id:"关键代码记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关键代码记录"}},[t._v("#")]),t._v(" 关键代码记录")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" table "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sheet.tables.add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tableSales'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 添加二维表\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" table "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sheet.tables.findByName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tableSales"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 通过表名获取表\n table.filterButtonVisible"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 隐藏筛选按钮\ntable.autoGenerateColumns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" //  如果是通过手动编辑spreadjs客户端生成的表样，为false时，才能正常显示spread.fromJSON"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("surveyPageData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 中表头信息\n\nspread.options.showHorizontalScrollbar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 隐藏水平滚动条\nspread.options.showVerticalScrollbar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 隐藏垂直滚动条\nspread.options.tabStripVisible "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 禁用下方sheet\nspread.options.allowContextMenu "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 禁用menu\nsheet.options.isProtected "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 启动保护\n\n\n\nsheet.getRange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("-1, "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", -1, "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(", GC.Spread.Sheets.SheetArea.viewport"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".locked"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 指定地方可编辑\n\n\n\n\n\nvar items2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("text: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1.男'")]),t._v(", value: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("text: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2.女'")]),t._v(", value: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvar eComboBoxCellType "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" new GC.Spread.Sheets.CellTypes.ComboBox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".items"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("items2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".editable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\neComboBoxCellType.editable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\neComboBoxCellType.editorValueType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GC.Spread.Sheets.CellTypes.EditorValueType.value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n      /**\n       * 添加行\n       */\n      "),a("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("addRow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" sheet "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this.spread.getActiveSheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" table "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sheet.tables.findByName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tableSales"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        var sels "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sheet.getSelections"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        var len "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sels.length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("len "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          var s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sels"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          sheet.addRows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sheet.getRowCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          console.log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sels, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'选中的'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          console.log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("table.dataRange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'表格的range'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          table.insertRows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s.row - table.dataRange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".row, "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          // sheet.addRows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s.row + "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n\n      /**\n       * 删除行\n       */\n      "),a("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("delRow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" sheet "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this.spread.getActiveSheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        var sels "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sheet.getSelections"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        var len "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sels.length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("len "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          var s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sels"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          sheet.deleteRows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s.row, s.rowCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n")])])]),a("h2",{attrs:{id:"注意"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[t._v("#")]),t._v(" 注意")]),t._v(" "),a("p",[t._v("在英文文档上写的type:any结果是，得用GC.Spread.Sheets.HorizontalAlign、GC.Spread.Sheets.ImageLayout这样的类型下面的类型才可以。根据实际情况用不同的类型")]),t._v(" "),a("p",[t._v("文档例子"),a("a",{attrs:{href:"https://demo.grapecity.com.cn/spreadjs/SpreadJSTutorial/features/data-binding/table-binding/purejs",target:"_blank",rel:"noopener noreferrer"}},[t._v("应用例子"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://help.grapecity.com.cn/pages/viewpage.action?pageId=5971735",target:"_blank",rel:"noopener noreferrer"}},[t._v("spreadjs帮助手册"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://gcdn.grapecity.com.cn/showtopic-45480-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("社区问题解决"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-jade extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("\n FarPoint.Web.Spread.DoubleCellType doubleType = new FarPoint.Web.Spread.DoubleCellType();            doubleType.CssClass =cssClass;\n\ngcSpreadSheet1.Sheets[0].Cells[1, 2].HorizontalAlignment = GrapeCity.Windows.SpreadSheet.Data.CellHorizontalAlignment.Right;\n\n\nthis.fpSpread1.ActiveSheet.DefaultStyle.HorizontalAlignment = FarPoint.Win.Spread.CellHorizontalAlignment.Right;\nthis.fpSpread1.ActiveSheet.DefaultStyle.VerticalAlignment = FarPoint.Win.Spread.CellVerticalAlignment.Bottom;\n")])])])],1)}),[],!1,null,null,null);s.default=e.exports}}]);