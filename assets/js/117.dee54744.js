(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{469:function(e,r,t){"use strict";t.r(r);var a=t(5),s=Object(a.a)({},(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("TOC"),e._v(" "),t("h2",{attrs:{id:"概要"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概要"}},[e._v("#")]),e._v(" 概要")]),e._v(" "),t("p",[e._v("spreadjs能够序列化，反序列化表格。熟练使用该功能能加快开发进度，减少代码量，降低业务复杂度，可以处理一些特别业务需求。")]),e._v(" "),t("p",[e._v("这几天在做一些报表相关的东西，涉及到的普查内容需要做成表格的形式。我们用的是葡萄城的spreadjs"),t("a",{attrs:{href:"https://www.grapecity.com/spreadjs/demos/features/workbook/data-source-serialize/purejs",target:"_blank",rel:"noopener noreferrer"}},[e._v("葡萄城地址"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"https://demo.grapecity.com.cn/spreadjs/SpreadJSTutorial/features/worksheet/protection/purejs",target:"_blank",rel:"noopener noreferrer"}},[e._v("葡萄城中文示例地址"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"https://gcdn.grapecity.com.cn/forum.php?mod=forumdisplay&fid=34",target:"_blank",rel:"noopener noreferrer"}},[e._v("葡萄城论坛地址"),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"问题描述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题描述"}},[e._v("#")]),e._v(" 问题描述")]),e._v(" "),t("p",[e._v("为了实现从一个已有的excel中获取 布局节约劳动力。 采用了 "),t("code",[e._v("this.spread.toJSON()")]),e._v(" 得到数据，"),t("code",[e._v("spread.fromJSON(JSON.parse(this.jsonStr))")]),e._v(" 来反序列化数据")]),e._v(" "),t("h4",{attrs:{id:"序列化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#序列化"}},[e._v("#")]),e._v(" 序列化")]),e._v(" "),t("p",[e._v("通过序列化可以将当前的整个spread序列化成为JSON格式进行存储。通过"),t("code",[e._v("spread.toJSON(serializationOption)")]),e._v("方法就可以做到，方法中还提供一些选项可以用来控制序列化的结果：")]),e._v(" "),t("div",{staticClass:"language-metadata json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("var serializationOption = {\nignoreFormula: true, // 如果设置为true则忽略公式，不会序列化公式，只会将公式计算的结果序列化到JSON中。\nignoreStyle: true, // 如果设置为true则忽略样式，所有style中的属性将不会序列化到JSON中\nrowHeadersAsFrozenColumns: true, // 将行头转换为冻结列序列化\ncolumnHeadersAsFrozenRows: true, // 将列头转换为冻结行序列化\nincludeBindingSource: true // 将数据绑定的数据源也序列化到json中\n}\n")])])]),t("h4",{attrs:{id:"反序列化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#反序列化"}},[e._v("#")]),e._v(" 反序列化")]),e._v(" "),t("p",[e._v("通过反序列化可以将之前序列化的JSON格式的对象反序列化成为页面进行展示。通过"),t("code",[e._v("spread2.fromJSON(json, jsonOptions)")]),e._v("方法可以做到，同样方法中也提供一些选项来控制反序列化的结果：")]),e._v(" "),t("div",{staticClass:"language-metadata json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("var jsonOptions = {\nignoreFormula: true, // 如果设置为true则忽略公式，反序列化时忽略公式，只会将公式计算的结果反序列化展示到页面中。\nignoreStyle: true, // 如果设置为true则忽略样式，不会将style中的属性反序列化展示\nfrozenColumnsAsRowHeaders: true, // 将冻结列转换为行头\nfrozenRowsAsColumnHeaders: true, // 将冻结行转换为列头\ndoNotRecalculateAfterLoad: true, // 反序列化后公式不进行重新计算\n}\n\n")])])]),t("h4",{attrs:{id:"设置可编辑和不可编辑单元格"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置可编辑和不可编辑单元格"}},[e._v("#")]),e._v(" 设置可编辑和不可编辑单元格")]),e._v(" "),t("p",[e._v("在返序列化后，某些单元格是需要readonly的，有些是不能readonly的。某些是需要可以编辑的。由于顺序问题，造成readonly失效。调整列宽也是无效的。")]),e._v(" "),t("h4",{attrs:{id:"解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[e._v("#")]),e._v(" 解决方案")]),e._v(" "),t("p",[e._v("fromJSON后需要重新获取一下sheet对象，因为之前的sheet在fromJSON的时候已经被销毁，fromJSON后的sheet对象已经不是之前那个sheet对象了，您需要重新获取一下，然后再用sheet.setColumnWidth(0,0)设置列宽")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://gcdn.grapecity.com.cn/showtopic-48173-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("答案来源"),t("OutboundLink")],1)])],1)}),[],!1,null,null,null);r.default=s.exports}}]);